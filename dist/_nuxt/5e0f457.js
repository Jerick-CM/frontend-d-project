(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1101:function(e,t,r){"use strict";r(699)},1102:function(e,t,r){(t=r(2)(!1)).push([e.i,".columnerror[data-v-8841f784]{background-color:#f08080!important}.row_error_start[data-v-8841f784]{border-left:1px solid red!important}.row_error_end[data-v-8841f784],.row_error_mid[data-v-8841f784],.row_error_start[data-v-8841f784]{border-bottom:1px solid red;border-top:1px solid red}.row_error_end[data-v-8841f784]{border-right:1px solid red}",""]),e.exports=t},1103:function(e,t,r){"use strict";r(700)},1104:function(e,t,r){(t=r(2)(!1)).push([e.i,".white-font[data-v-8841f784]{color:#fff}",""]),e.exports=t},1177:function(e,t,r){"use strict";r.r(t);r(447),r(450),r(186),r(189),r(20),r(430),r(550),r(187),r(13),r(34),r(78),r(123);var o=r(31),n=r(10),d=(r(14),r(4)),c=r(424),l=r(12),m=r(0),_=r(434),v=r.n(_),f=r(552),h=r.n(f);function w(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}r(44);m.default.use(v.a);var x={mounted:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var r,data;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("/users",{params:{page:1,paginate:0,sort:"name:asc",blast:1}});case 2:r=t.sent,data=r.data,e.items=data,console.log(data);case 6:case"end":return t.stop()}}),t)})))()},mixins:[c.a],data:function(){var e;return{pagination:{rowsPerPage:-1},headers:[(e={text:"Email",align:"left",sortable:!1},Object(n.a)(e,"align","left"),Object(n.a)(e,"value","name"),e),{text:"RO Deduct",sortable:!1},{text:"RO Add",sortable:!1},{text:"MR Deduct",sortable:!1},{text:"MR Add",sortable:!1},{text:"Message",sortable:!1},{text:"Admin Log Message",sortable:!1},{text:"Send EDM",sortable:!1}],csvcontent:[],items:[""],progressBar:!1,progressBarvalue:0,report_upload:"",positions:[],positionsCopy:[],updateSelection:[],searchTimeOut:null,searchFilter:"",search:null,dialog:!1,isSaving:!1,isMassUploadProcess:!1,filename_masstokenupdate:"",csv_masstokenupload:"",id:9,masstoken_error:!1}},created:function(){var e=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var r,data,n,d,c,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.progressBar=!0,t.next=4,e.$axios.get("/api/fetch-myrewards",{});case 4:for(r=t.sent,data=[],n=0,d=Object.entries(r.data.data.badge_rewards_token);n<d.length;n++)c=Object(o.a)(d[n],2),c[0],l=c[1],data.push({id:l.id,description:l.description,rewardstoken:l.rewardstoken,created_at:l.created_at,updated_at:l.updated_at});e.progressBarvalue=100,e.progressBar=!1,e.badgerewardtoken=data,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.progressBar=!1;case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},methods:{onPickFile_masstokenupdate:function(){this.$refs.csv_masstokenupload.value=null,this.$refs.csv_masstokenupload.click()},fireSendEmail_masstokenupdate:function(){var e=this,t=new FormData;this.isMassUploadProcess=!0,t.append("csv_masstokenupload",this.csv_masstokenupload),this.$axios.post("/admin/edm/masstokenupdate/"+this.id,t,{}).then(function(){var t=Object(d.a)(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.isMassUploadProcess=!1,e.$toast.success("Mass Token Upload success.");case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.isMassUploadProcess=!1,t.response.data.errormsg?e.$toast.error(t.response.data.errormsg):e.$toast.error("Mass Token Upload error.")})).finally((function(){}))},applyCsvupload:function(e,t){var r=this;return Object(d.a)(regeneratorRuntime.mark((function t(){var o,n,d,i,c,l,m,_,v,f,h,w,x,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r.masstoken_error=!1,r.report_upload="",[],[],o=[],r.emails,n=[],d=[],i=0;i<e.data.length;i++)0==i&&(d.push({text:e.data[i][0],sortable:!1,align:"left"}),d.push({text:e.data[i][1],sortable:!1}),d.push({text:e.data[i][2],sortable:!1}),d.push({text:e.data[i][3],sortable:!1}),d.push({text:e.data[i][4],sortable:!1}),d.push({text:e.data[i][5],sortable:!1}),d.push({text:e.data[i][6],sortable:!1}),d.push({text:e.data[i][7],sortable:!1})),e.data[i][1]&&(!1,i>0&&(c=r.items.find((function(element){return element.email.toLowerCase()==e.data[i][0].toLowerCase()})),l=!1,m=!1,""==e.data[i][0]&&(r.masstoken_error=!0,m=!0),c||(r.masstoken_error=!0,m=!0,l=!0,o.push(e.data[i][0])),_=!1,""==e.data[i][1]&&(r.masstoken_error=!0,_=!0,l=!0),Number.isInteger(parseFloat(e.data[i][1]))&&parseFloat(e.data[i][1])>=0||(r.masstoken_error=!0,_=!0,l=!0),v=!1,""==e.data[i][2]&&(r.masstoken_error=!0,v=!0,l=!0),Number.isInteger(parseFloat(e.data[i][2]))&&parseFloat(e.data[i][2])>=0||(r.masstoken_error=!0,v=!0,l=!0),f=!1,""==e.data[i][3]&&(r.masstoken_error=!0,f=!0,l=!0),Number.isInteger(parseFloat(e.data[i][3]))&&parseFloat(e.data[i][3])>=0||(r.masstoken_error=!0,f=!0,l=!0),h=!1,""==e.data[i][4]&&(r.masstoken_error=!0,h=!0,l=!0),Number.isInteger(parseFloat(e.data[i][4]))&&parseFloat(e.data[i][4])>=0||(r.masstoken_error=!0,h=!0,l=!0),w=!1,"yes"==e.data[i][7].toLowerCase()&&""==e.data[i][5]&&(r.masstoken_error=!0,w=!0,l=!0),x=e.data[i][5],k=(k=x.replace(/=(\r\n|\n|\r)/gm,"<br>")).replace("\\\n","<br>"),k=unescape(k.split("\\n").join("<br>")),console.log(k),n.push({email:e.data[i][0],ro_deduct:e.data[i][1],ro_add:e.data[i][2],mr_deduct:e.data[i][3],mr_add:e.data[i][4],message:unescape(k),adminlogmessage:e.data[i][6],sendedm:e.data[i][7],row_error:l,email_error:m,ro_deduct_error:_,ro_add_error:v,mr_deduct_error:f,mr_add_error:h,message_error:w})));r.csvcontent=n,console.log(d),r.headers=d,1==r.masstoken_error&&r.$toast.error("Unable to process because there's error with the data, please update and reupload the csv.");case 13:case"end":return t.stop()}}),t)})))()},handlecsv_upload:function(e){var t=e.target.files;void 0!==t[0]&&h.a.parse(t[0],{complete:this.applyCsvupload});try{this.$refs.csv_masstokenupload.files[0];this.csv_masstokenupload=this.$refs.csv_masstokenupload.files[0],this.filename_masstokenupdate=this.$refs.csv_masstokenupload.files[0].name,console.log(this.filename_masstokenupdate)}catch(e){console.log(e)}}},computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?w(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):w(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(l.b)({profile:"session/GET_PROFILE"})),watch:{}},k=(r(1101),r(1103),r(9)),component=Object(k.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"user-levels-page"}},[r("div",{staticClass:"container no-padding"},[r("v-toolbar",{attrs:{flat:"",color:"white"}},[r("v-toolbar-title",[e._v("Mass Token Update")]),e._v(" "),r("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),e._v(" "),r("v-spacer")],1),e._v(" "),r("div",{staticClass:"container no-padding",staticStyle:{"background-color":"white"}},[r("v-container",{attrs:{fluid:""}},[r("br"),e._v(" "),9==e.id?r("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}):e._e(),e._v(" "),9==e.id?r("v-spacer"):e._e(),e._v(" "),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("input",{ref:"csv_masstokenupload",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.handlecsv_upload}}),e._v(" "),r("v-btn",{attrs:{color:"primary"},on:{click:e.onPickFile_masstokenupdate}},[e._v("Select file")]),e._v("\n\n            "+e._s(e.filename_masstokenupdate)+"\n          ")],1)],1),e._v(" "),""!=e.csvcontent?r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.csvcontent,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return[r("td",{staticClass:"text-xs-right",class:{columnerror:t.item.email_error,row_error_start:t.item.row_error}},[e._v("\n                  "+e._s(t.item.email)+"\n                ")]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_mid:t.item.row_error,columnerror:t.item.ro_deduct_error}},[e._v("\n                  "+e._s(t.item.ro_deduct)+"\n                ")]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_mid:t.item.row_error,columnerror:t.item.ro_add_error}},[e._v("\n                  "+e._s(t.item.ro_add)+"\n                ")]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_mid:t.item.row_error,columnerror:t.item.mr_deduct_error}},[e._v("\n                  "+e._s(t.item.mr_deduct)+"\n                ")]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_mid:t.item.row_error,columnerror:t.item.mr_add_error}},[e._v("\n                  "+e._s(t.item.mr_add)+"\n                ")]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_mid:t.item.row_error,columnerror:t.item.message_error}},[r("span",{domProps:{innerHTML:e._s(t.item.message)}})]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_mid:t.item.row_error}},[e._v("\n                  "+e._s(t.item.adminlogmessage)+"\n                ")]),e._v(" "),r("td",{staticClass:"text-xs-right",class:{row_error_end:t.item.row_error}},[e._v("\n                  "+e._s(t.item.sendedm)+"\n                ")])]}}],null,!1,3578624024)})],1)],1):e._e(),e._v(" "),r("v-layout",{attrs:{row:""}},[r("v-flex",{attrs:{xs12:""}},[r("div",{staticStyle:{color:"red"}},[e._v("\n              "+e._s(e.report_upload)+"\n            ")])])],1),e._v(" "),r("v-layout",{attrs:{row:""}},[r("v-btn",{attrs:{color:"success",loading:e.isMassUploadProcess,disabled:e.masstoken_error},on:{click:function(t){return e.fireSendEmail_masstokenupdate()}}},[r("label",{staticClass:"white-font"},[e._v("Process")])])],1)],1)],1),e._v(" "),r("div",{staticClass:"controls m-lg-vertical"})],1)])}),[],!1,null,"8841f784",null);t.default=component.exports},424:function(e,t,r){"use strict";r(14);var o=r(4);t.a={middleware:"authenticated",layout:"admin",asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.store,o=e.error,t.next=3,r.dispatch("session/fetchUserProfile");case 3:return t.next=5,r.getters["session/IS_ADMIN"];case 5:t.sent||o({statusCode:404,message:"Page not found"});case 7:case"end":return t.stop()}}),t)})))()}}},699:function(e,t,r){var content=r(1102);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(3).default)("7dbf73e4",content,!0,{sourceMap:!1})},700:function(e,t,r){var content=r(1104);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(3).default)("12aa9def",content,!0,{sourceMap:!1})}}]);