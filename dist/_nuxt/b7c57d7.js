(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{1180:function(t,e,n){"use strict";n.r(e);n(28),n(186),n(35),n(45),n(33),n(48),n(13),n(34),n(36),n(116),n(46),n(75),n(47);var o=n(10);function r(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var l={mixins:[n(424).a],mounted:function(){var t=this;this.getDataFromApi().then((function(e){t.positions=e.items,t.positionsCopy=JSON.parse(JSON.stringify(e.items)),t.table.totalItems=e.totalItems}))},data:function(){return{table:{headers:[{text:"Career level",value:"career_level",sortable:!0},{text:"Head count",value:"head_count",sortable:!1},{text:"Quarterly token allowance",value:"monthly_token_allocation",sortable:!0},{text:"Maximum send token limit",value:"max_token_send_to_same_user",sortable:!0}],page:1,totalItems:0,isLoading:!1},pagination:{},positions:[],positionsCopy:[],updateSelection:[],searchTimeOut:null,searchFilter:"",search:null,dialog:!1,isSaving:!1}},methods:{close:function(){this.dialog=!1},doUpdate:function(){var t=this,e=[];this.updateSelection.forEach((function(i){var n={monthly_token_allocation:i.monthly_token_allocation,max_token_send_to_same_user:i.max_token_send_to_same_user};e.push(t.$axios.put("/admin/user-levels/".concat(i.id),n))})),this.isSaving=!0,Promise.all(e).then((function(e){t.isSaving=!1,t.$toast.success("User levels has been successfully been updated."),t.positionsCopy=JSON.parse(JSON.stringify(t.positions)),t.updateSelection=[]})).catch((function(){t.isSaving=!1}))},getDataFromApi:function(){var t=this;return this.table.isLoading=!0,new Promise((function(e,n){var l=t.pagination,c=l.sortBy,d=l.descending,h=l.page,m=l.rowsPerPage,_={page:h};-1===m?_.paginate=0:_.rpp=m||5,c&&(_.sort="".concat(c,":").concat(d?"desc":"asc")),t.search&&(_.search=t.search),t.$axios.get(t.$queryBuilder("/admin/user-levels",_)).then((function(t){var n=t.data.data;-1===m&&(n=t.data),e({items:n.map((function(i){return function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?r(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):r(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},i)})),totalItems:t.data.total})})).catch((function(t){n(t.response)})).finally((function(){t.table.isLoading=!1}))}))},resetSelection:function(){this.positions=JSON.parse(JSON.stringify(this.positionsCopy)),this.updateSelection=[]},isExistingOnSelection:function(t){return-1!==this.updateSelection.findIndex((function(u){return u.id===t}))},addOrUpdateToSelection:function(t){if(this.isExistingOnSelection(t.id)){var e=this.updateSelection.findIndex((function(u){return u.id===t.id}));this.updateSelection[e]=Object.assign({},t)}else this.updateSelection.push(t)},removeFromSelection:function(t){var e=this.updateSelection.findIndex((function(u){return u.id===t}));e>=0&&this.updateSelection.splice(e,1)},getFromSelection:function(t){return this.updateSelection.find((function(u){return u.id===t}))}},computed:{selected:function(){for(var i=0,t=this.positions.length;i<t;++i){var e=this.positions[i].id;if(this.positionsCopy[i].monthly_token_allocation!==this.positions[i].monthly_token_allocation||this.positionsCopy[i].max_token_send_to_same_user!==this.positions[i].max_token_send_to_same_user)this.addOrUpdateToSelection(this.positions[i]);else if(this.isExistingOnSelection(e)){this.getFromSelection(e);this.exist&&this.exist.monthly_token_allocation===this.positionsCopy[i].monthly_token_allocation&&this.exist.max_token_send_to_same_user===this.positionsCopy[i].max_token_send_to_same_user&&this.removeFromSelection(e)}}return!0}},watch:{pagination:{handler:function(t){var e=this;this.getDataFromApi().then((function(t){e.positions=t.items,e.positionsCopy=JSON.parse(JSON.stringify(t.items)),e.table.totalItems=t.totalItems}))},deep:!0},searchFilter:function(t){var e=this;this.searchTimeOut&&clearTimeout(this.searchTimeOut),this.searchTimeOut=setTimeout((function(){e.searchFilter.length>=3?e.search=e.searchFilter:e.search=null}),300)}}},c=n(9),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.selected?n("div",{attrs:{id:"user-levels-page"}},[n("div",{staticClass:"container no-padding"},[n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-toolbar-title",[t._v("User levels")]),t._v(" "),n("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),n("v-spacer")],1),t._v(" "),n("v-data-table",{attrs:{headers:t.table.headers,items:t.positions,search:t.search,loading:t.table.isLoading,pagination:t.pagination,"total-items":t.table.totalItems,"item-key":"id"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[n("tr",[n("td",[n("h3",[t._v(t._s(e.item.career_level))])]),t._v(" "),n("td",[n("h3",[t._v(t._s(e.item.head_count))])]),t._v(" "),n("td",[n("v-text-field",{attrs:{color:"light-green lighten-1",type:"number",min:"0"},model:{value:e.item.monthly_token_allocation,callback:function(n){t.$set(e.item,"monthly_token_allocation",n)},expression:"props.item.monthly_token_allocation"}})],1),t._v(" "),n("td",[n("v-text-field",{attrs:{color:"light-green lighten-1",type:"number",min:"0"},model:{value:e.item.max_token_send_to_same_user,callback:function(n){t.$set(e.item,"max_token_send_to_same_user",n)},expression:"props.item.max_token_send_to_same_user"}})],1)])]}}],null,!1,1273754789)},[t._v(" "),n("v-alert",{attrs:{slot:"no-results",value:!0,color:"error",icon:"warning"},slot:"no-results"},[t._v('\n        Your search for "'+t._s(t.search)+'" found no results.\n      ')])],1),t._v(" "),n("div",{staticClass:"controls m-lg-vertical right"},[n("v-btn",{attrs:{disabled:0===t.updateSelection.length,loading:t.isSaving,dark:""},on:{click:function(e){return t.doUpdate()}}},[t._v("Save")]),t._v(" "),n("v-btn",{attrs:{dark:"",disabled:0===t.updateSelection.length},on:{click:function(e){return t.resetSelection()}}},[t._v("Cancel")])],1)],1)]):t._e()}),[],!1,null,null,null);e.default=component.exports},424:function(t,e,n){"use strict";n(14);var o=n(4);e.a={middleware:"authenticated",layout:"admin",asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.store,o=t.error,e.next=3,n.dispatch("session/fetchUserProfile");case 3:return e.next=5,n.getters["session/IS_ADMIN"];case 5:e.sent||o({statusCode:404,message:"Page not found"});case 7:case"end":return e.stop()}}),e)})))()}}}}]);