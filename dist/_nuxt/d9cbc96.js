(window.webpackJsonp=window.webpackJsonp||[]).push([[17,18],{1146:function(t,e,n){"use strict";n.r(e);var o=n(424),r=n(582),c={mixins:[o.a,r.default]},d=(n(765),n(9)),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"model-page"}},[n("div",{staticClass:"container no-padding"},[n("v-toolbar",{attrs:{flat:"",color:"white"}},[n("v-toolbar-title",[t._v("Item category")]),t._v(" "),n("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),n("v-spacer"),t._v(" "),n("v-dialog",{attrs:{"max-width":"500px",width:"500px"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("v-btn",{attrs:{slot:"activator",type:"button",dark:""},slot:"activator"},[t._v("Add category")]),t._v(" "),n("v-card",[n("v-card-text",[n("h4",[t._v(t._s(t.formTitle))]),t._v(" "),n("form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("v-card-text",[n("v-text-field",{attrs:{label:"Name",color:"light-green lighten-1"},model:{value:t.editedItem.name,callback:function(e){t.$set(t.editedItem,"name",e)},expression:"editedItem.name"}})],1),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{dark:""},on:{click:t.close}},[t._v("Close")]),t._v(" "),n("v-btn",{attrs:{dark:"",type:"submit"}},[t._v("Save")]),t._v("Â \n              ")],1)],1)])],1)],1)],1),t._v(" "),n("v-data-table",{attrs:{headers:t.table.headers,items:t.categories,loading:t.table.isLoading,pagination:t.pagination,"total-items":t.table.totalItems,"item-key":"id"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[n("td",[n("h3",[t._v(t._s(e.item.name))])]),t._v(" "),n("td",[n("v-tooltip",{attrs:{top:""}},[n("v-icon",{staticClass:"clickable",attrs:{slot:"activator"},on:{click:function(n){return t.editItem(e.item.id)}},slot:"activator"},[t._v("edit")]),t._v(" "),n("span",{staticClass:"uppercase"},[t._v("Edit")])],1),t._v(" "),n("v-tooltip",{attrs:{top:""}},[n("v-icon",{staticClass:"clickable",attrs:{slot:"activator"},on:{click:function(n){return t.deleteCategory(e.item.id)}},slot:"activator"},[t._v("delete")]),t._v(" "),n("span",{staticClass:"uppercase"},[t._v("Delete")])],1)],1)]}}])}),t._v(" "),n("br"),n("br")],1)])}),[],!1,null,"4f104692",null);e.default=component.exports},424:function(t,e,n){"use strict";n(14);var o=n(4);e.a={middleware:"authenticated",layout:"admin",asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.store,o=t.error,e.next=3,n.dispatch("session/fetchUserProfile");case 3:return e.next=5,n.getters["session/IS_ADMIN"];case 5:e.sent||o({statusCode:404,message:"Page not found"});case 7:case"end":return e.stop()}}),e)})))()}}},582:function(t,e,n){"use strict";n.r(e);n(28),n(35),n(45),n(20),n(13),n(46),n(14);var o=n(4);e.default={mounted:function(){var t=this;this.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems}))},methods:{onCategoryChange:function(t){var e=this;t.forEach((function(t,n){"string"==typeof t&&e.addNewCategory(t,n)}))},addNewCategory:function(t,e){var n=this;this.isCategoryLoading=!0;var o={name:t};this.$axios.post("/admin/categories",o).then((function(t){var o=t.data;n.categories.push(o),n.editedItem.categories[e]=o})).finally((function(){n.isCategoryLoading=!1}))},getDataFromApi:function(){var t=this;return this.table.isLoading=!0,new Promise((function(e,n){var o=t.pagination,r=o.sortBy,c=o.descending,d=o.page,l=o.rowsPerPage,m={page:d};-1===l?m.paginate=0:m.rpp=l||5,r&&(m.sort="".concat(r,":").concat(c?"desc":"asc")),t.$axios.get(t.$queryBuilder("/admin/categories",m)).then((function(t){var n=t.data.data;-1===l&&(n=t.data),e({items:n,totalItems:t.data.total})})).catch((function(t){n(t.response)})).finally((function(){t.table.isLoading=!1}))}))},getItemPhoto:function(t){return t?t.file:""},editItem:function(t){this.editedIndex=this.categories.findIndex((function(e){return e.id===t})),this.editedItem=Object.assign({},JSON.parse(JSON.stringify(this.categories[this.editedIndex]))),this.dialog=!0},close:function(){this.dialog=!1,this.editedIndex=-1,this.resetForm()},resetForm:function(){this.editedItem=Object.assign({},this.defaultItem)},create:function(){var t=this,e=new FormData;e.append("name",this.editedItem.name),this.$axios.post("/admin/categories",e).then((function(){t.$toast.success("New category added."),t.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems})),t.close()})).catch((function(e){for(var n in e.response.data){e.response.data[n].forEach((function(e){t.$toast.error(e)}))}}))},update:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FormData).append("name",t.editedItem.name),n.append("_method","PUT"),t.$axios.post("/admin/categories/".concat(t.editedItem.id),n).then((function(){t.$toast.success("Successfully updated category."),t.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems,t.close()}))})).catch((function(e){for(var n in e.response.data){e.response.data[n].forEach((function(e){t.$toast.error(e)}))}}));case 4:case"end":return e.stop()}}),e)})))()},deleteCategory:function(t){var e=this;new FormData;this.$axios.delete("/admin/categories/".concat(t)).then((function(){e.$toast.success("Successfully removed category."),e.getDataFromApi().then((function(t){e.categories=t.items,e.table.totalItems=t.totalItems}))})).catch((function(t){for(var n in t.response.data){t.response.data[n].forEach((function(t){e.$toast.error(t)}))}}))},submit:function(){-1===this.editedIndex?this.create():this.update()}},data:function(){return{table:{headers:[{text:"Name",value:"name",sortable:!0},{text:"Action",value:"name",sortable:!1}],page:1,totalItems:0,isLoading:!1},pagination:{},dialog:!1,editedIndex:-1,editedItem:{name:""},defaultItem:{name:""},categories:[]}},computed:{formTitle:function(){return-1===this.editedIndex?"Add new category":"Edit ".concat(this.editedItem.name)}},watch:{pagination:{handler:function(){var t=this;this.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems}))},deep:!0}}}},583:function(t,e,n){var content=n(766);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(3).default)("734d06a2",content,!0,{sourceMap:!1})},765:function(t,e,n){"use strict";n(583)},766:function(t,e,n){(e=n(2)(!1)).push([t.i,".discontinued .v-btn[data-v-4f104692]{background-color:#a9a9a9!important}.photo-details[data-v-4f104692]{height:200px;max-height:200px}",""]),t.exports=e}}]);