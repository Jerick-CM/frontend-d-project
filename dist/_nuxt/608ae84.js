(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{426:function(t,e){t.exports=function(data,t,e,o){var n=new Blob(void 0!==o?[o,data]:[data],{type:e||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{var r=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(n):window.webkitURL.createObjectURL(n),c=document.createElement("a");c.style.display="none",c.href=r,c.setAttribute("download",t),void 0===c.download&&c.setAttribute("target","_blank"),document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),window.URL.revokeObjectURL(r)}),200)}}},437:function(t,e,o){var n=o(7);e.f=n},447:function(t,e,o){"use strict";var n=o(5),r=o(6),c=o(39),d=o(38),l=o(19),h=o(122),f=o(192),m=o(8),v=o(21),y=o(82),w=o(16),I=o(11),S=o(26),k=o(30),D=o(74),x=o(59),P=o(115),O=o(60),$=o(114),_=o(448),j=o(121),L=o(58),E=o(23),C=o(79),T=o(25),R=o(24),A=o(119),F=o(80),U=o(81),z=o(120),B=o(7),M=o(437),N=o(449),J=o(77),Q=o(50),G=o(32).forEach,W=F("hidden"),Y=B("toPrimitive"),H=Q.set,K=Q.getterFor("Symbol"),V=Object.prototype,X=r.Symbol,Z=c("JSON","stringify"),tt=L.f,et=E.f,ot=_.f,nt=C.f,it=A("symbols"),at=A("op-symbols"),st=A("string-to-symbol-registry"),ct=A("symbol-to-string-registry"),ut=A("wks"),lt=r.QObject,ht=!lt||!lt.prototype||!lt.prototype.findChild,pt=l&&m((function(){return 7!=P(et({},"a",{get:function(){return et(this,"a",{value:7}).a}})).a}))?function(t,e,o){var n=tt(V,e);n&&delete V[e],et(t,e,o),n&&t!==V&&et(V,e,n)}:et,ft=function(t,e){var symbol=it[t]=P(X.prototype);return H(symbol,{type:"Symbol",tag:t,description:e}),l||(symbol.description=e),symbol},mt=f?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof X},gt=function(t,e,o){t===V&&gt(at,e,o),I(t);var n=D(e,!0);return I(o),v(it,n)?(o.enumerable?(v(t,W)&&t[W][n]&&(t[W][n]=!1),o=P(o,{enumerable:x(0,!1)})):(v(t,W)||et(t,W,x(1,{})),t[W][n]=!0),pt(t,n,o)):et(t,n,o)},vt=function(t,e){I(t);var o=k(e),n=O(o).concat(It(o));return G(n,(function(e){l&&!yt.call(o,e)||gt(t,e,o[e])})),t},yt=function(t){var e=D(t,!0),o=nt.call(this,e);return!(this===V&&v(it,e)&&!v(at,e))&&(!(o||!v(this,e)||!v(it,e)||v(this,W)&&this[W][e])||o)},bt=function(t,e){var o=k(t),n=D(e,!0);if(o!==V||!v(it,n)||v(at,n)){var r=tt(o,n);return!r||!v(it,n)||v(o,W)&&o[W][n]||(r.enumerable=!0),r}},wt=function(t){var e=ot(k(t)),o=[];return G(e,(function(t){v(it,t)||v(U,t)||o.push(t)})),o},It=function(t){var e=t===V,o=ot(e?at:k(t)),n=[];return G(o,(function(t){!v(it,t)||e&&!v(V,t)||n.push(it[t])})),n};(h||(R((X=function(){if(this instanceof X)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=z(t),o=function(t){this===V&&o.call(at,t),v(this,W)&&v(this[W],e)&&(this[W][e]=!1),pt(this,e,x(1,t))};return l&&ht&&pt(V,e,{configurable:!0,set:o}),ft(e,t)}).prototype,"toString",(function(){return K(this).tag})),R(X,"withoutSetter",(function(t){return ft(z(t),t)})),C.f=yt,E.f=gt,L.f=bt,$.f=_.f=wt,j.f=It,M.f=function(t){return ft(B(t),t)},l&&(et(X.prototype,"description",{configurable:!0,get:function(){return K(this).description}}),d||R(V,"propertyIsEnumerable",yt,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:X}),G(O(ut),(function(t){N(t)})),n({target:"Symbol",stat:!0,forced:!h},{for:function(t){var e=String(t);if(v(st,e))return st[e];var symbol=X(e);return st[e]=symbol,ct[symbol]=e,symbol},keyFor:function(t){if(!mt(t))throw TypeError(t+" is not a symbol");if(v(ct,t))return ct[t]},useSetter:function(){ht=!0},useSimple:function(){ht=!1}}),n({target:"Object",stat:!0,forced:!h,sham:!l},{create:function(t,e){return void 0===e?P(t):vt(P(t),e)},defineProperty:gt,defineProperties:vt,getOwnPropertyDescriptor:bt}),n({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:wt,getOwnPropertySymbols:It}),n({target:"Object",stat:!0,forced:m((function(){j.f(1)}))},{getOwnPropertySymbols:function(t){return j.f(S(t))}}),Z)&&n({target:"JSON",stat:!0,forced:!h||m((function(){var symbol=X();return"[null]"!=Z([symbol])||"{}"!=Z({a:symbol})||"{}"!=Z(Object(symbol))}))},{stringify:function(t,e,o){for(var n,r=[t],c=1;arguments.length>c;)r.push(arguments[c++]);if(n=e,(w(e)||void 0!==t)&&!mt(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!mt(e))return e}),r[1]=e,Z.apply(null,r)}});X.prototype[Y]||T(X.prototype,Y,X.prototype.valueOf),J(X,"Symbol"),U[W]=!0},448:function(t,e,o){var n=o(30),r=o(114).f,c={}.toString,d="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return d&&"[object Window]"==c.call(t)?function(t){try{return r(t)}catch(t){return d.slice()}}(t):r(n(t))}},449:function(t,e,o){var path=o(191),n=o(21),r=o(437),c=o(23).f;t.exports=function(t){var e=path.Symbol||(path.Symbol={});n(e,t)||c(e,t,{value:r.f(t)})}},450:function(t,e,o){"use strict";var n=o(5),r=o(19),c=o(6),d=o(21),l=o(16),h=o(23).f,f=o(190),m=c.Symbol;if(r&&"function"==typeof m&&(!("description"in m.prototype)||void 0!==m().description)){var v={},y=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof y?new m(t):void 0===t?m():m(t);return""===t&&(v[e]=!0),e};f(y,m);var w=y.prototype=m.prototype;w.constructor=y;var I=w.toString,S="Symbol(test)"==String(m("test")),k=/^Symbol\((.*)\)[^)]+$/;h(w,"description",{configurable:!0,get:function(){var symbol=l(this)?this.valueOf():this,t=I.call(symbol);if(d(v,symbol))return"";var desc=S?t.slice(7,-1):t.replace(k,"$1");return""===desc?void 0:desc}}),n({global:!0,forced:!0},{Symbol:y})}},580:function(t,e,o){"use strict";o.r(e);o(447),o(450),o(28),o(35),o(45),o(33),o(48),o(20),o(13),o(36),o(46),o(75),o(47),o(14);var n=o(4),r=o(10);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var l=o(426);e.default={mounted:function(){var t=this;this.fetchItems(),this.getDownloadableLogs().then((function(e){t.downloadableLogs=e.items,t.logsTable.totalItems=e.totalItems})),this.primaryPhotoDropzone=this.$refs.primaryPhotoDropzone,this.otherPhotoDropzone=this.$refs.otherPhotoDropzone},methods:{downloadFile:function(t){var e=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get(this.$queryBuilder("/admin/logs/download",{id:t.id}),{responseType:"blob"}).then((function(t){l(t.data,"inventory_"+Date.now()+".csv")})).catch((function(t){t.response&&e.$toast.error(t.response.data.message)})).finally((function(){e.isDownloading=!1})))},getDownloadableLogs:function(){var t=this;return this.logsTable.isLoading=!0,new Promise((function(e,o){var n=t.logsTablePagination,r=n.sortBy,c=n.descending,d=n.page,l=n.rowsPerPage,h={page:d,query:"type:Inventory Management"};-1===l?h.paginate=0:h.rpp=l||5,r&&(h.sort="".concat(r,":").concat(c?"desc":"asc"));t.$axios.get(t.$queryBuilder("/admin/logs/downloadables",h)).then((function(t){var o=t.data.data;-1===l&&(o=t.data),e({items:o,totalItems:t.data.total})})).catch((function(t){o(t.response)})).finally((function(){t.logsTable.isLoading=!1}))}))},generateCsv:function(){var t=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get("".concat(this.currentDownloadExcelURL,"&download=1")).then((function(e){t.getDownloadableLogs().then((function(e){t.downloadableLogs=e.items,t.logsTable.totalItems=e.totalItems}))})).catch((function(e){t.$toast.error(e.response.data.message)})).finally((function(){t.isDownloading=!1})))},removeMeta:function(t){this.editedItem.meta.splice(t,1)},onCategoryChange:function(t){var e=this;t.forEach((function(t,o){"string"==typeof t&&e.addNewCategory(t,o)}))},addNewCategory:function(t,e){var o=this;this.isCategoryLoading=!0;var n={name:t};this.$axios.post("/admin/categories",n).then((function(t){var e=d(d({},t.data),{},{deleted_at:null});o.categories.push(e),o.editedItem.categories.pop(),o.editedItem.categories.push(e)})).finally((function(){o.isCategoryLoading=!1}))},getCategories:function(){var t=this;this.$axios.get(this.$queryBuilder("/admin/categories",{paginate:0})).then((function(e){t.categories=e.data})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}}))},downloadExcel:function(){var t=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get("".concat(this.currentDownloadExcelURL,"&download=1"),{responseType:"blob"}).then((function(t){l(t.data,"inventory.xlsx")})).catch((function(e){t.$toast.error(e.response.data.message)})).finally((function(){t.isDownloading=!1})))},getDataFromApi:function(){var t=this;return this.table.isLoading=!0,new Promise((function(e,o){var n=t.pagination,r=n.sortBy,c=n.descending,l=n.page,h=n.rowsPerPage,f={page:l};-1===h?f.paginate=0:f.rpp=h||5,r&&(f.sort="".concat(r,":").concat(c?"desc":"asc")),t.currentDownloadExcelURL=t.$queryBuilder("/admin/rewards",f),t.$axios.get(t.$queryBuilder("/admin/rewards",f)).then((function(t){var o=t.data.data;-1===h&&(o=t.data),o.map((function(i){return d(d({},i),{},{isDeleting:!1})})),e({items:o,totalItems:t.data.total})})).catch((function(t){o(t.response)})).finally((function(){t.table.isLoading=!1}))}))},getItemPhoto:function(t){return t?t.file:""},editItem:function(t){this.editedIndex=this.rewards.findIndex((function(e){return e.id===t}));var e=Object.assign({},JSON.parse(JSON.stringify(this.rewards[this.editedIndex])));this.editedItem=Object.assign({photo:""},d(d({},e),{},{inventory_photos:e.inventory_photos.sort((function(a,b){return a.order-b.order}))})),this.dialog=!0},close:function(){this.dialog=!1,this.stockDialog=!1,this.sortMode=!1,this.editedItem.meta=null,this.editedIndex=-1,this.toDeletePhoto=[],this.categories=[],this.newPrimaryPhotoID=null,this.$refs.otherPhotoDropzone.removeAllFiles(!0),this.resetForm()},resetForm:function(){this.editedItem=Object.assign({},this.defaultItem),this.$refs.photo&&(this.$refs.photo.value=""),this.$refs.otherPhoto&&(this.$refs.otherPhoto.value="")},create:function(){var t=this,e=new FormData;this.$refs.otherPhotoDropzone.dropzone.files.forEach((function(t,o){e.append("photos[".concat(o,"][file]"),t)})),e.append("name",this.editedItem.name),e.append("description",this.editedItem.description),e.append("short_desc",this.editedItem.short_desc),e.append("unit_price",this.editedItem.unit_price),e.append("is_visible",this.editedItem.is_visible),e.append("is_preorder",this.editedItem.is_preorder),e.append("stock",this.editedItem.stock),this.editedItem.categories.forEach((function(t,o){e.append("categories[".concat(o,"]"),t.id)})),this.editedItem.meta&&this.editedItem.meta.forEach((function(t,o){e.append("meta[".concat(o,"][key]"),t.key),e.append("meta[".concat(o,"][val]"),t.val)})),this.isSaving=!0,this.$axios.post("/admin/rewards",e).then((function(){t.$toast.success("Item added to inventory."),t.fetchItems(),t.close()})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}})).finally((function(){t.isSaving=!1}))},update:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=new FormData).append("name",t.editedItem.name),o.append("description",t.editedItem.description),o.append("short_desc",t.editedItem.short_desc),o.append("unit_price",t.editedItem.unit_price),o.append("is_visible",t.editedItem.is_visible),o.append("is_preorder",t.editedItem.is_preorder),o.append("_method","PUT"),t.editedItem.categories.forEach((function(t,e){o.append("categories[".concat(e,"]"),t.id)})),t.editedItem.meta&&t.editedItem.meta.forEach((function(t,e){o.append("meta[".concat(e,"][key]"),t.key),o.append("meta[".concat(e,"][val]"),t.val)})),null===t.newPrimaryPhotoID){e.next=15;break}return n=t.newPrimaryPhotoID,e.next=14,t.$axios.post("/admin/rewards/".concat(t.editedItem.id,"/photo/").concat(n,"/set-primary"),o);case 14:e.sent;case 15:t.isSaving=!0,t.toDeletePhoto.length>0?(r=[],t.toDeletePhoto.forEach((function(e){r.push(t.$axios.delete("/admin/rewards/".concat(t.editedItem.id,"/photo/").concat(e)))})),Promise.all(r).then((function(){t.isSaving=!1,t.$axios.post("/admin/rewards/".concat(t.editedItem.id),o).then((function(){t.$toast.success("Updated the item successfully."),t.fetchItems(!0)})).catch((function(e){t.$toast.error("An error has occured.")}))})).catch((function(e){t.isSaving=!1,t.$toast.error("An error has occured.")}))):t.$axios.post("/admin/rewards/".concat(t.editedItem.id),o).then((function(){t.fetchItems(!0)})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}})).finally((function(){t.isSaving=!1}));case 17:case"end":return e.stop()}}),e)})))()},uploadOtherPhotos:function(){var t=this,e=this.$refs.otherPhotoDropzone.dropzone.files;if(0!==e.length){var o=new FormData;e.forEach((function(t,e){o.append("photos[".concat(e,"][file]"),t)})),this.$axios.post("/admin/rewards/".concat(this.editedItem.id,"/photo"),o).then((function(){t.getDataFromApi().then((function(e){t.rewards=e.items,t.table.totalItems=e.totalItems})),t.close()})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}}))}},deleteOtherPhoto:function(t,e){this.toDeletePhoto.push(t),this.editedItem.inventory_photos.splice(e,1)},setPrimaryPhoto:function(t,e){this.newPrimaryPhotoID=t;for(var i=0,o=this.editedItem.inventory_photos.length;i<o;++i)this.editedItem.inventory_photos[i].id!==t?this.editedItem.inventory_photos[i].is_primary=0:this.editedItem.inventory_photos[i].is_primary=1},updateSort:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={photos:t.editedItem.inventory_photos.map((function(t,e){return{id:t.id,order:e+1}}))},t.isSaving=!0,e.next=4,t.$axios.post("/admin/rewards/".concat(t.editedItem.id,"/photo/sort"),o);case 4:n=e.sent,t.isSaving=!1,n?t.update():t.$toast.error("An error has occured");case 7:case"end":return e.stop()}}),e)})))()},submit:function(){-1===this.editedIndex?this.create():(this.updateSort(),this.uploadOtherPhotos())},deleteItem:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function o(){var n,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n={title:"Delete confirmation",buttonTrueText:"Confirm delete",buttonFalseText:"Cancel",buttonFalseColor:"red",buttonTrueColor:"light-green lighten-1",color:"black",icon:""},o.next=3,e.$confirm('<div class="center">You are about to delete an item!<br>Click on "Confirm delete" to proceed.</div>',n);case 3:o.sent&&(e.table.isLoading=!0,r=e.rewards.findIndex((function(e){return e.id===t})),e.rewards[r].isDeleting=!0,e.$axios.delete("/admin/rewards/".concat(t)).then((function(){e.$toast.success("Item successfully deleted."),e.fetchItems()})).catch((function(t){t.response?e.$toast.error(t.response.message):e.$toast.error(t)})).finally((function(){e.rewards[r].isDeleting=!1})));case 5:case"end":return o.stop()}}),o)})))()},editStock:function(t,e){var o=this;this.editStockModeCredit=e,this.editStockIndex=this.rewards.findIndex((function(e){return e.id===t})),this.editStockItem=Object.assign({},this.rewards[this.editStockIndex]),this.stockDialog=!0,setTimeout((function(){o.$refs.txtEditStock.focus()}),100)},closeStockDialog:function(){var t=this;this.dialog=!1,this.stockDialog=!1,this.editStockAmount=null,setTimeout((function(){t.editStockItem=Object.assign({},{amount:0}),t.editStockIndex=-1}),300)},submitEditStock:function(){this.editStockModeCredit?this.credit():this.debit()},credit:function(){var t=this;this.$axios.put("/admin/rewards/".concat(this.editStockItem.id,"/credit"),{amount:this.editStockAmount?this.editStockAmount:0}).then((function(e){t.editStockAmount=null,t.editStockIndex=-1,t.$toast.success("Item stock updated."),t.stockDialog=!1,t.getDataFromApi().then((function(e){t.rewards=e.items,t.table.totalItems=e.totalItems}))})).catch((function(e){t.$toast.error(e.response.data)}))},debit:function(){var t=this;this.$axios.put("/admin/rewards/".concat(this.editStockItem.id,"/debit"),{amount:this.editStockAmount?this.editStockAmount:0}).then((function(e){t.editStockAmount=null,t.editStockIndex=-1,t.$toast.success("Item stock updated."),t.stockDialog=!1,t.fetchItems()})).catch((function(e){t.$toast.error(e.response.data)}))},onFileChange:function(t){this.editedItem.photo=t.target.files[0]},addItemMeta:function(){this.editedItem.meta?this.editedItem.meta.push({key:"",val:""}):this.editedItem.meta=[{key:"",val:""}]},fetchItems:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getDataFromApi().then((function(o){t.rewards=o.items,t.table.totalItems=o.totalItems,e&&t.close()}))}},data:function(){return{downloadableLogs:[],logsTable:{headers:[{text:"Date Generated",value:"created_at",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"",value:"",sortable:!1}],page:1,totalItems:0,isLoading:!1},logsTablePagination:{sortBy:"created_at",descending:!0},table:{headers:[{text:"Preview image",value:"photo",sortable:!1},{text:"Product name",value:"name",sortable:!0},{text:"Updated",value:"updated_at",sortable:!0},{text:"Quantity",value:"stock",sortable:!0},{text:"Item value",value:"unit_price",sortable:!0},{text:"Action",value:"name",sortable:!1}],page:1,totalItems:0,isLoading:!1},pagination:{},dialog:!1,editedIndex:-1,editedItem:{name:"",primary_photo:"",description:"",short_desc:"",unit_price:0,stock:0,is_visible:1,is_preorder:0,photo:"",meta:[],categories:[]},defaultItem:{name:"",description:"",short_desc:"",primary_photo:"",unit_price:0,stock:0,is_visible:1,is_preorder:0,photo:"",meta:[],inventory_photos:[],categories:[]},stockDialog:!1,editStockAmount:null,editStockModeCredit:null,editStockIndex:-1,editStockItem:{name:"",unit_price:0,stock:0,is_visible:0,is_preorder:0},rewards:[],categories:[],isCategoryLoading:!1,primaryPhotoDropzone:null,otherPhotoDropzone:null,dropzoneOpts:{primaryOptions:{url:"/",acceptedFiles:"image/*",uploadMultiple:!1,addRemoveLinks:!0,parallelUploads:1,maxFiles:1},otherOptions:{url:"/",acceptedFiles:"image/*",uploadMultiple:!0,addRemoveLinks:!0},destroyDropzone:!0,duplicateCheck:!0},sortMode:!1,drag:!1,toDeletePhoto:[],newPrimaryPhotoID:null,isSaving:!1,currentDownloadExcelURL:"",isDownloading:!1}},computed:{formTitle:function(){return-1===this.editedIndex?"Add new item":"Edit ".concat(this.editedItem.name)},stockFormTitle:function(){return this.editStockModeCredit?"Add Stock":"Reduce Stock"}},watch:{logsTablePagination:{handler:function(t){var e=this;this.getDownloadableLogs().then((function(t){e.downloadableLogs=t.items,e.logsTable.totalItems=t.totalItems}))},deep:!0},pagination:{handler:function(){this.fetchItems()},deep:!0},dialog:function(){this.dialog&&this.getCategories()}}}}}]);