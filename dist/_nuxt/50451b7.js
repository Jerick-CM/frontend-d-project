(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{582:function(t,e,n){"use strict";n.r(e);n(28),n(35),n(45),n(20),n(13),n(46),n(14);var o=n(4);e.default={mounted:function(){var t=this;this.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems}))},methods:{onCategoryChange:function(t){var e=this;t.forEach((function(t,n){"string"==typeof t&&e.addNewCategory(t,n)}))},addNewCategory:function(t,e){var n=this;this.isCategoryLoading=!0;var o={name:t};this.$axios.post("/admin/categories",o).then((function(t){var o=t.data;n.categories.push(o),n.editedItem.categories[e]=o})).finally((function(){n.isCategoryLoading=!1}))},getDataFromApi:function(){var t=this;return this.table.isLoading=!0,new Promise((function(e,n){var o=t.pagination,r=o.sortBy,c=o.descending,d=o.page,m=o.rowsPerPage,f={page:d};-1===m?f.paginate=0:f.rpp=m||5,r&&(f.sort="".concat(r,":").concat(c?"desc":"asc")),t.$axios.get(t.$queryBuilder("/admin/categories",f)).then((function(t){var n=t.data.data;-1===m&&(n=t.data),e({items:n,totalItems:t.data.total})})).catch((function(t){n(t.response)})).finally((function(){t.table.isLoading=!1}))}))},getItemPhoto:function(t){return t?t.file:""},editItem:function(t){this.editedIndex=this.categories.findIndex((function(e){return e.id===t})),this.editedItem=Object.assign({},JSON.parse(JSON.stringify(this.categories[this.editedIndex]))),this.dialog=!0},close:function(){this.dialog=!1,this.editedIndex=-1,this.resetForm()},resetForm:function(){this.editedItem=Object.assign({},this.defaultItem)},create:function(){var t=this,e=new FormData;e.append("name",this.editedItem.name),this.$axios.post("/admin/categories",e).then((function(){t.$toast.success("New category added."),t.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems})),t.close()})).catch((function(e){for(var n in e.response.data){e.response.data[n].forEach((function(e){t.$toast.error(e)}))}}))},update:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=new FormData).append("name",t.editedItem.name),n.append("_method","PUT"),t.$axios.post("/admin/categories/".concat(t.editedItem.id),n).then((function(){t.$toast.success("Successfully updated category."),t.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems,t.close()}))})).catch((function(e){for(var n in e.response.data){e.response.data[n].forEach((function(e){t.$toast.error(e)}))}}));case 4:case"end":return e.stop()}}),e)})))()},deleteCategory:function(t){var e=this;new FormData;this.$axios.delete("/admin/categories/".concat(t)).then((function(){e.$toast.success("Successfully removed category."),e.getDataFromApi().then((function(t){e.categories=t.items,e.table.totalItems=t.totalItems}))})).catch((function(t){for(var n in t.response.data){t.response.data[n].forEach((function(t){e.$toast.error(t)}))}}))},submit:function(){-1===this.editedIndex?this.create():this.update()}},data:function(){return{table:{headers:[{text:"Name",value:"name",sortable:!0},{text:"Action",value:"name",sortable:!1}],page:1,totalItems:0,isLoading:!1},pagination:{},dialog:!1,editedIndex:-1,editedItem:{name:""},defaultItem:{name:""},categories:[]}},computed:{formTitle:function(){return-1===this.editedIndex?"Add new category":"Edit ".concat(this.editedItem.name)}},watch:{pagination:{handler:function(){var t=this;this.getDataFromApi().then((function(e){t.categories=e.items,t.table.totalItems=e.totalItems}))},deep:!0}}}}}]);