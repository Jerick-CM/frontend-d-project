(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1145:function(t,e,o){"use strict";o.r(e);var n=o(761),r=o.n(n),d=o(556),c=o.n(d),l=(o(557),o(424)),m=o(580),h={components:{Dropzone:c.a,draggable:r.a},mixins:[l.a,m.default]},v=(o(763),o(9)),component=Object(v.a)(h,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"model-page"}},[o("div",{staticClass:"container no-padding"},[o("v-toolbar",{attrs:{flat:"",color:"white"}},[o("v-toolbar-title",{staticStyle:{width:"250px"}},[t._v("Inventory management")]),t._v(" "),o("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),o("v-spacer"),t._v(" "),o("v-dialog",{attrs:{fullscreen:"","hide-overlay":"",transition:"dialog-bottom-transition"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[o("v-btn",{attrs:{slot:"activator",type:"button",dark:""},slot:"activator"},[t._v("Add Item")]),t._v(" "),o("v-card",[o("v-toolbar",{attrs:{dark:""}},[o("v-btn",{attrs:{icon:"",dark:""},on:{click:function(e){return t.close()}}},[o("v-icon",[t._v("close")])],1),t._v(" "),o("v-toolbar-title",[t._v(t._s(t.formTitle))]),t._v(" "),o("v-spacer"),t._v(" "),o("v-toolbar-items",[o("v-btn",{attrs:{loading:t.isSaving,dark:"",flat:""},on:{click:function(e){return t.submit()}}},[t._v("Save")])],1)],1),t._v(" "),o("v-card-text",[o("div",{staticClass:"container--flex mb-4"},[o("div",{staticClass:"flex-1 preview-item"},[o("h4",[o("span",{staticStyle:{"vertical-align":"middle"}},[t._v("Item photos")]),t._v(" "),t.editedItem.primary_photo?o("v-btn",{staticStyle:{"vertical-align":"middle"},attrs:{dark:""},on:{click:function(e){e.preventDefault(),t.sortMode=!t.sortMode}}},[t.sortMode?o("span",[t._v("Done")]):o("span",[t._v("Edit sort")])]):t._e()],1),t._v(" "),t.editedItem.primary_photo?o("div",{staticClass:"photo-details mt-4"},[t.sortMode?o("div",[o("draggable",{staticClass:"container--flex container--flex-wrap align-center",on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1}},model:{value:t.editedItem.inventory_photos,callback:function(e){t.$set(t.editedItem,"inventory_photos",e)},expression:"editedItem.inventory_photos"}},t._l(t.editedItem.inventory_photos,(function(t,e){return o("div",{key:e,staticClass:"flex-1 clickable",staticStyle:{"max-width":"150px",position:"relative",height:"150px",margin:"0 20px"}},[o("img",{key:e,staticClass:"responsive-img",attrs:{src:t.file}})])})),0)],1):o("div",{staticClass:"container--flex container--flex-wrap align-center"},t._l(t.editedItem.inventory_photos,(function(e,n){return o("div",{key:n,staticClass:"flex-1",staticStyle:{"max-width":"150px",position:"relative",height:"150px",margin:"0 20px"}},[1===e.is_primary?o("i",{staticClass:"material-icons",staticStyle:{position:"absolute",top:"0",left:"0",color:"#94b944"}},[t._v("star")]):t._e(),t._v(" "),o("img",{key:n,staticClass:"responsive-img clickable",attrs:{src:e.file},on:{click:function(o){return t.setPrimaryPhoto(e.id,n)}}}),t._v(" "),1!==e.is_primary?o("i",{staticClass:"material-icons clickable",staticStyle:{position:"absolute",top:"0"},on:{click:function(o){return t.deleteOtherPhoto(e.id,n)}}},[t._v("highlight_off")]):t._e()])})),0)]):t._e(),t._v(" "),o("span",[t._v("Add photo(s)")]),t._v(" "),o("dropzone",{ref:"otherPhotoDropzone",attrs:{options:t.dropzoneOpts.otherOptions,duplicateCheck:t.dropzoneOpts.duplicateCheck,destroyDropzone:t.dropzoneOpts.destroyDropzone}})],1)]),t._v(" "),o("v-text-field",{attrs:{label:"Name",color:"light-green lighten-1",maxlength:"40",counter:"40",required:""},model:{value:t.editedItem.name,callback:function(e){t.$set(t.editedItem,"name",e)},expression:"editedItem.name"}}),t._v(" "),o("v-textarea",{attrs:{label:"Description",color:"light-green lighten-1"},model:{value:t.editedItem.description,callback:function(e){t.$set(t.editedItem,"description",e)},expression:"editedItem.description"}}),t._v(" "),o("v-text-field",{attrs:{label:"New product description",color:"light-green lighten-1",maxlength:"50",counter:"50",required:""},model:{value:t.editedItem.short_desc,callback:function(e){t.$set(t.editedItem,"short_desc",e)},expression:"editedItem.short_desc"}}),t._v(" "),-1===t.editedIndex?o("v-text-field",{attrs:{label:"Quantity",type:"number",required:"",min:"0",color:"light-green lighten-1"},model:{value:t.editedItem.stock,callback:function(e){t.$set(t.editedItem,"stock",e)},expression:"editedItem.stock"}}):t._e(),t._v(" "),o("v-text-field",{attrs:{label:"Unit price",type:"number",min:"0",color:"light-green lighten-1",required:""},model:{value:t.editedItem.unit_price,callback:function(e){t.$set(t.editedItem,"unit_price",e)},expression:"editedItem.unit_price"}}),t._v(" "),o("v-combobox",{attrs:{items:t.categories,loading:t.isCategoryLoading,"item-text":"name","item-value":"id",label:"Category",color:"light-green lighten-1",clearable:"",multiple:"",chips:""},on:{change:t.onCategoryChange},model:{value:t.editedItem.categories,callback:function(e){t.$set(t.editedItem,"categories",e)},expression:"editedItem.categories"}},[o("template",{slot:"no-data"},[o("v-list-tile",[o("v-list-tile-content",[o("v-list-tile-title",[t._v("\n                      Press\n                      "),o("kbd",[t._v("enter")]),t._v(" to add.\n                    ")])],1)],1)],1)],2),t._v(" "),o("v-checkbox",{attrs:{label:"Discontinued","true-value":0,"false-value":1,color:"light-green lighten-1"},model:{value:t.editedItem.is_visible,callback:function(e){t.$set(t.editedItem,"is_visible",e)},expression:"editedItem.is_visible"}}),t._v(" "),o("v-checkbox",{attrs:{label:"Pre-order","true-value":1,"false-value":0,color:"light-green lighten-1"},model:{value:t.editedItem.is_preorder,callback:function(e){t.$set(t.editedItem,"is_preorder",e)},expression:"editedItem.is_preorder"}}),t._v(" "),o("br"),t._v(" "),o("br"),t._v(" "),o("h5",[t._v("Item metadata")]),t._v(" "),t.editedItem.meta?o("v-container",{staticStyle:{margin:"0 !important"},attrs:{fluid:"","grid-list-md":""}},t._l(t.editedItem.meta,(function(e,n){return o("v-layout",{key:n,attrs:{row:"",wrap:""}},[o("v-flex",{attrs:{xs5:""}},[o("v-text-field",{attrs:{label:"Label",color:"light-green lighten-1",required:""},model:{value:e.key,callback:function(o){t.$set(e,"key",o)},expression:"item.key"}})],1),t._v(" "),o("v-flex",{attrs:{xs5:""}},[o("v-text-field",{attrs:{label:"Value",color:"light-green lighten-1",required:""},model:{value:e.val,callback:function(o){t.$set(e,"val",o)},expression:"item.val"}})],1),t._v(" "),o("v-flex",{attrs:{xs2:""}},[o("v-btn",{attrs:{flat:"",small:""},on:{click:function(e){return t.removeMeta(n)}}},[o("v-icon",[t._v("remove_circle")])],1)],1)],1)})),1):t._e(),t._v(" "),o("v-btn",{attrs:{flat:"",small:""},on:{click:function(e){return t.addItemMeta()}}},[o("v-icon",{attrs:{left:"",dark:""}},[t._v("add")]),t._v("Add item metadata\n            ")],1)],1)],1)],1)],1),t._v(" "),o("v-dialog",{attrs:{"max-width":"500px",width:"500px"},model:{value:t.stockDialog,callback:function(e){t.stockDialog=e},expression:"stockDialog"}},[o("v-card",[o("v-card-title",[o("h3",[t._v(t._s(t.stockFormTitle))])]),t._v(" "),o("form",{on:{submit:function(e){return e.preventDefault(),t.submitEditStock(e)}}},[o("v-card-text",[-1===t.editedIndex?o("v-text-field",{ref:"txtEditStock",attrs:{label:"Quantity",type:"number",min:"0",placeholder:"0",color:"light-green lighten-1"},model:{value:t.editStockAmount,callback:function(e){t.editStockAmount=e},expression:"editStockAmount"}}):t._e()],1),t._v(" "),o("v-card-actions",[o("v-spacer"),t._v(" "),o("v-btn",{attrs:{dark:""},on:{click:t.closeStockDialog}},[t._v("Close")]),t._v(" "),o("v-btn",{attrs:{dark:"",type:"submit"}},[t._v("Save")]),t._v("Â \n          ")],1)],1)],1)],1),t._v(" "),o("v-data-table",{attrs:{headers:t.table.headers,items:t.rewards,loading:t.table.isLoading,pagination:t.pagination,"total-items":t.table.totalItems,"item-key":"id"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[o("td",[o("img",{staticClass:"pt-1",attrs:{src:t.getItemPhoto(e.item.primary_photo),width:"100",alt:e.item.name}})]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.name))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(t.$moment(e.item.updated_at).format("DD MMM YYYY")))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.stock))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.unit_price))])]),t._v(" "),o("td",{class:{discontinued:0===e.item.is_visible}},[o("v-btn",{staticClass:"white--text",attrs:{small:"",color:"light-green lighten-1"},on:{click:function(o){return o.preventDefault(),t.editItem(e.item.id)}}},[t._v("Edit")]),t._v(" "),o("v-btn",{staticClass:"white--text",attrs:{small:"",color:"light-green lighten-1"},on:{click:function(o){return o.preventDefault(),t.editStock(e.item.id,1)}}},[t._v("Add Stock")]),t._v(" "),o("v-btn",{staticClass:"white--text",attrs:{small:"",color:"light-green lighten-1"},on:{click:function(o){return o.preventDefault(),t.editStock(e.item.id,0)}}},[t._v("Reduce Stock")]),t._v(" "),o("v-btn",{staticClass:"white--text",staticStyle:{background:"#ee2323 !important"},attrs:{loading:e.item.isDeleting,small:""},on:{click:function(o){return o.preventDefault(),t.deleteItem(e.item.id)}}},[t._v("Delete")])],1)]}}])}),t._v(" "),o("div",{staticClass:"container no-padding",staticStyle:{"margin-top":"25px !important"}},[o("v-toolbar",{staticClass:"pt-4",attrs:{flat:"",color:"white"}},[o("v-toolbar-title",[t._v("Downloadable logs")]),t._v(" "),o("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),o("v-btn",{staticClass:"right",attrs:{dark:""},on:{click:function(e){return t.generateCsv()}}},[t._v("Generate log file")]),t._v(" "),o("v-spacer")],1),t._v(" "),o("v-data-table",{attrs:{headers:t.logsTable.headers,items:t.downloadableLogs,loading:t.logsTable.isLoading,pagination:t.logsTablePagination,"total-items":t.logsTable.totalItems,"item-key":"id"},on:{"update:pagination":function(e){t.logsTablePagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[o("td",[o("h3",[t._v(t._s(e.item.created_at))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.status))])]),t._v(" "),o("td",["ready"==e.item.status?o("v-btn",{staticClass:"right",attrs:{dark:""},on:{click:function(o){return t.downloadFile(e.item)}}},[t._v("Download")]):t._e()],1)]}}])})],1),t._v(" "),o("br"),t._v(" "),o("br")],1)])}),[],!1,null,"31968d48",null);e.default=component.exports},424:function(t,e,o){"use strict";o(14);var n=o(4);e.a={middleware:"authenticated",layout:"admin",asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.store,n=t.error,e.next=3,o.dispatch("session/fetchUserProfile");case 3:return e.next=5,o.getters["session/IS_ADMIN"];case 5:e.sent||n({statusCode:404,message:"Page not found"});case 7:case"end":return e.stop()}}),e)})))()}}},580:function(t,e,o){"use strict";o.r(e);o(447),o(450),o(28),o(35),o(45),o(33),o(48),o(20),o(13),o(36),o(46),o(75),o(47),o(14);var n=o(4),r=o(10);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function c(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var l=o(426);e.default={mounted:function(){var t=this;this.fetchItems(),this.getDownloadableLogs().then((function(e){t.downloadableLogs=e.items,t.logsTable.totalItems=e.totalItems})),this.primaryPhotoDropzone=this.$refs.primaryPhotoDropzone,this.otherPhotoDropzone=this.$refs.otherPhotoDropzone},methods:{downloadFile:function(t){var e=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get(this.$queryBuilder("/admin/logs/download",{id:t.id}),{responseType:"blob"}).then((function(t){l(t.data,"inventory_"+Date.now()+".csv")})).catch((function(t){t.response&&e.$toast.error(t.response.data.message)})).finally((function(){e.isDownloading=!1})))},getDownloadableLogs:function(){var t=this;return this.logsTable.isLoading=!0,new Promise((function(e,o){var n=t.logsTablePagination,r=n.sortBy,d=n.descending,c=n.page,l=n.rowsPerPage,m={page:c,query:"type:Inventory Management"};-1===l?m.paginate=0:m.rpp=l||5,r&&(m.sort="".concat(r,":").concat(d?"desc":"asc"));t.$axios.get(t.$queryBuilder("/admin/logs/downloadables",m)).then((function(t){var o=t.data.data;-1===l&&(o=t.data),e({items:o,totalItems:t.data.total})})).catch((function(t){o(t.response)})).finally((function(){t.logsTable.isLoading=!1}))}))},generateCsv:function(){var t=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get("".concat(this.currentDownloadExcelURL,"&download=1")).then((function(e){t.getDownloadableLogs().then((function(e){t.downloadableLogs=e.items,t.logsTable.totalItems=e.totalItems}))})).catch((function(e){t.$toast.error(e.response.data.message)})).finally((function(){t.isDownloading=!1})))},removeMeta:function(t){this.editedItem.meta.splice(t,1)},onCategoryChange:function(t){var e=this;t.forEach((function(t,o){"string"==typeof t&&e.addNewCategory(t,o)}))},addNewCategory:function(t,e){var o=this;this.isCategoryLoading=!0;var n={name:t};this.$axios.post("/admin/categories",n).then((function(t){var e=c(c({},t.data),{},{deleted_at:null});o.categories.push(e),o.editedItem.categories.pop(),o.editedItem.categories.push(e)})).finally((function(){o.isCategoryLoading=!1}))},getCategories:function(){var t=this;this.$axios.get(this.$queryBuilder("/admin/categories",{paginate:0})).then((function(e){t.categories=e.data})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}}))},downloadExcel:function(){var t=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get("".concat(this.currentDownloadExcelURL,"&download=1"),{responseType:"blob"}).then((function(t){l(t.data,"inventory.xlsx")})).catch((function(e){t.$toast.error(e.response.data.message)})).finally((function(){t.isDownloading=!1})))},getDataFromApi:function(){var t=this;return this.table.isLoading=!0,new Promise((function(e,o){var n=t.pagination,r=n.sortBy,d=n.descending,l=n.page,m=n.rowsPerPage,h={page:l};-1===m?h.paginate=0:h.rpp=m||5,r&&(h.sort="".concat(r,":").concat(d?"desc":"asc")),t.currentDownloadExcelURL=t.$queryBuilder("/admin/rewards",h),t.$axios.get(t.$queryBuilder("/admin/rewards",h)).then((function(t){var o=t.data.data;-1===m&&(o=t.data),o.map((function(i){return c(c({},i),{},{isDeleting:!1})})),e({items:o,totalItems:t.data.total})})).catch((function(t){o(t.response)})).finally((function(){t.table.isLoading=!1}))}))},getItemPhoto:function(t){return t?t.file:""},editItem:function(t){this.editedIndex=this.rewards.findIndex((function(e){return e.id===t}));var e=Object.assign({},JSON.parse(JSON.stringify(this.rewards[this.editedIndex])));this.editedItem=Object.assign({photo:""},c(c({},e),{},{inventory_photos:e.inventory_photos.sort((function(a,b){return a.order-b.order}))})),this.dialog=!0},close:function(){this.dialog=!1,this.stockDialog=!1,this.sortMode=!1,this.editedItem.meta=null,this.editedIndex=-1,this.toDeletePhoto=[],this.categories=[],this.newPrimaryPhotoID=null,this.$refs.otherPhotoDropzone.removeAllFiles(!0),this.resetForm()},resetForm:function(){this.editedItem=Object.assign({},this.defaultItem),this.$refs.photo&&(this.$refs.photo.value=""),this.$refs.otherPhoto&&(this.$refs.otherPhoto.value="")},create:function(){var t=this,e=new FormData;this.$refs.otherPhotoDropzone.dropzone.files.forEach((function(t,o){e.append("photos[".concat(o,"][file]"),t)})),e.append("name",this.editedItem.name),e.append("description",this.editedItem.description),e.append("short_desc",this.editedItem.short_desc),e.append("unit_price",this.editedItem.unit_price),e.append("is_visible",this.editedItem.is_visible),e.append("is_preorder",this.editedItem.is_preorder),e.append("stock",this.editedItem.stock),this.editedItem.categories.forEach((function(t,o){e.append("categories[".concat(o,"]"),t.id)})),this.editedItem.meta&&this.editedItem.meta.forEach((function(t,o){e.append("meta[".concat(o,"][key]"),t.key),e.append("meta[".concat(o,"][val]"),t.val)})),this.isSaving=!0,this.$axios.post("/admin/rewards",e).then((function(){t.$toast.success("Item added to inventory."),t.fetchItems(),t.close()})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}})).finally((function(){t.isSaving=!1}))},update:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=new FormData).append("name",t.editedItem.name),o.append("description",t.editedItem.description),o.append("short_desc",t.editedItem.short_desc),o.append("unit_price",t.editedItem.unit_price),o.append("is_visible",t.editedItem.is_visible),o.append("is_preorder",t.editedItem.is_preorder),o.append("_method","PUT"),t.editedItem.categories.forEach((function(t,e){o.append("categories[".concat(e,"]"),t.id)})),t.editedItem.meta&&t.editedItem.meta.forEach((function(t,e){o.append("meta[".concat(e,"][key]"),t.key),o.append("meta[".concat(e,"][val]"),t.val)})),null===t.newPrimaryPhotoID){e.next=15;break}return n=t.newPrimaryPhotoID,e.next=14,t.$axios.post("/admin/rewards/".concat(t.editedItem.id,"/photo/").concat(n,"/set-primary"),o);case 14:e.sent;case 15:t.isSaving=!0,t.toDeletePhoto.length>0?(r=[],t.toDeletePhoto.forEach((function(e){r.push(t.$axios.delete("/admin/rewards/".concat(t.editedItem.id,"/photo/").concat(e)))})),Promise.all(r).then((function(){t.isSaving=!1,t.$axios.post("/admin/rewards/".concat(t.editedItem.id),o).then((function(){t.$toast.success("Updated the item successfully."),t.fetchItems(!0)})).catch((function(e){t.$toast.error("An error has occured.")}))})).catch((function(e){t.isSaving=!1,t.$toast.error("An error has occured.")}))):t.$axios.post("/admin/rewards/".concat(t.editedItem.id),o).then((function(){t.fetchItems(!0)})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}})).finally((function(){t.isSaving=!1}));case 17:case"end":return e.stop()}}),e)})))()},uploadOtherPhotos:function(){var t=this,e=this.$refs.otherPhotoDropzone.dropzone.files;if(0!==e.length){var o=new FormData;e.forEach((function(t,e){o.append("photos[".concat(e,"][file]"),t)})),this.$axios.post("/admin/rewards/".concat(this.editedItem.id,"/photo"),o).then((function(){t.getDataFromApi().then((function(e){t.rewards=e.items,t.table.totalItems=e.totalItems})),t.close()})).catch((function(e){for(var o in e.response.data){e.response.data[o].forEach((function(e){t.$toast.error(e)}))}}))}},deleteOtherPhoto:function(t,e){this.toDeletePhoto.push(t),this.editedItem.inventory_photos.splice(e,1)},setPrimaryPhoto:function(t,e){this.newPrimaryPhotoID=t;for(var i=0,o=this.editedItem.inventory_photos.length;i<o;++i)this.editedItem.inventory_photos[i].id!==t?this.editedItem.inventory_photos[i].is_primary=0:this.editedItem.inventory_photos[i].is_primary=1},updateSort:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={photos:t.editedItem.inventory_photos.map((function(t,e){return{id:t.id,order:e+1}}))},t.isSaving=!0,e.next=4,t.$axios.post("/admin/rewards/".concat(t.editedItem.id,"/photo/sort"),o);case 4:n=e.sent,t.isSaving=!1,n?t.update():t.$toast.error("An error has occured");case 7:case"end":return e.stop()}}),e)})))()},submit:function(){-1===this.editedIndex?this.create():(this.updateSort(),this.uploadOtherPhotos())},deleteItem:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function o(){var n,r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n={title:"Delete confirmation",buttonTrueText:"Confirm delete",buttonFalseText:"Cancel",buttonFalseColor:"red",buttonTrueColor:"light-green lighten-1",color:"black",icon:""},o.next=3,e.$confirm('<div class="center">You are about to delete an item!<br>Click on "Confirm delete" to proceed.</div>',n);case 3:o.sent&&(e.table.isLoading=!0,r=e.rewards.findIndex((function(e){return e.id===t})),e.rewards[r].isDeleting=!0,e.$axios.delete("/admin/rewards/".concat(t)).then((function(){e.$toast.success("Item successfully deleted."),e.fetchItems()})).catch((function(t){t.response?e.$toast.error(t.response.message):e.$toast.error(t)})).finally((function(){e.rewards[r].isDeleting=!1})));case 5:case"end":return o.stop()}}),o)})))()},editStock:function(t,e){var o=this;this.editStockModeCredit=e,this.editStockIndex=this.rewards.findIndex((function(e){return e.id===t})),this.editStockItem=Object.assign({},this.rewards[this.editStockIndex]),this.stockDialog=!0,setTimeout((function(){o.$refs.txtEditStock.focus()}),100)},closeStockDialog:function(){var t=this;this.dialog=!1,this.stockDialog=!1,this.editStockAmount=null,setTimeout((function(){t.editStockItem=Object.assign({},{amount:0}),t.editStockIndex=-1}),300)},submitEditStock:function(){this.editStockModeCredit?this.credit():this.debit()},credit:function(){var t=this;this.$axios.put("/admin/rewards/".concat(this.editStockItem.id,"/credit"),{amount:this.editStockAmount?this.editStockAmount:0}).then((function(e){t.editStockAmount=null,t.editStockIndex=-1,t.$toast.success("Item stock updated."),t.stockDialog=!1,t.getDataFromApi().then((function(e){t.rewards=e.items,t.table.totalItems=e.totalItems}))})).catch((function(e){t.$toast.error(e.response.data)}))},debit:function(){var t=this;this.$axios.put("/admin/rewards/".concat(this.editStockItem.id,"/debit"),{amount:this.editStockAmount?this.editStockAmount:0}).then((function(e){t.editStockAmount=null,t.editStockIndex=-1,t.$toast.success("Item stock updated."),t.stockDialog=!1,t.fetchItems()})).catch((function(e){t.$toast.error(e.response.data)}))},onFileChange:function(t){this.editedItem.photo=t.target.files[0]},addItemMeta:function(){this.editedItem.meta?this.editedItem.meta.push({key:"",val:""}):this.editedItem.meta=[{key:"",val:""}]},fetchItems:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getDataFromApi().then((function(o){t.rewards=o.items,t.table.totalItems=o.totalItems,e&&t.close()}))}},data:function(){return{downloadableLogs:[],logsTable:{headers:[{text:"Date Generated",value:"created_at",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"",value:"",sortable:!1}],page:1,totalItems:0,isLoading:!1},logsTablePagination:{sortBy:"created_at",descending:!0},table:{headers:[{text:"Preview image",value:"photo",sortable:!1},{text:"Product name",value:"name",sortable:!0},{text:"Updated",value:"updated_at",sortable:!0},{text:"Quantity",value:"stock",sortable:!0},{text:"Item value",value:"unit_price",sortable:!0},{text:"Action",value:"name",sortable:!1}],page:1,totalItems:0,isLoading:!1},pagination:{},dialog:!1,editedIndex:-1,editedItem:{name:"",primary_photo:"",description:"",short_desc:"",unit_price:0,stock:0,is_visible:1,is_preorder:0,photo:"",meta:[],categories:[]},defaultItem:{name:"",description:"",short_desc:"",primary_photo:"",unit_price:0,stock:0,is_visible:1,is_preorder:0,photo:"",meta:[],inventory_photos:[],categories:[]},stockDialog:!1,editStockAmount:null,editStockModeCredit:null,editStockIndex:-1,editStockItem:{name:"",unit_price:0,stock:0,is_visible:0,is_preorder:0},rewards:[],categories:[],isCategoryLoading:!1,primaryPhotoDropzone:null,otherPhotoDropzone:null,dropzoneOpts:{primaryOptions:{url:"/",acceptedFiles:"image/*",uploadMultiple:!1,addRemoveLinks:!0,parallelUploads:1,maxFiles:1},otherOptions:{url:"/",acceptedFiles:"image/*",uploadMultiple:!0,addRemoveLinks:!0},destroyDropzone:!0,duplicateCheck:!0},sortMode:!1,drag:!1,toDeletePhoto:[],newPrimaryPhotoID:null,isSaving:!1,currentDownloadExcelURL:"",isDownloading:!1}},computed:{formTitle:function(){return-1===this.editedIndex?"Add new item":"Edit ".concat(this.editedItem.name)},stockFormTitle:function(){return this.editStockModeCredit?"Add Stock":"Reduce Stock"}},watch:{logsTablePagination:{handler:function(t){var e=this;this.getDownloadableLogs().then((function(t){e.downloadableLogs=t.items,e.logsTable.totalItems=t.totalItems}))},deep:!0},pagination:{handler:function(){this.fetchItems()},deep:!0},dialog:function(){this.dialog&&this.getCategories()}}}},581:function(t,e,o){var content=o(764);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(3).default)("2d819217",content,!0,{sourceMap:!1})},763:function(t,e,o){"use strict";o(581)},764:function(t,e,o){(e=o(2)(!1)).push([t.i,".discontinued .v-btn[data-v-31968d48]{background-color:#a9a9a9!important}.photo-details[data-v-31968d48]{height:200px;max-height:200px}",""]),t.exports=e}}]);