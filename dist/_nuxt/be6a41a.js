(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1095:function(t,e,o){"use strict";o(696)},1096:function(t,e,o){(e=o(2)(!1)).push([t.i,"#user-transactions-page .container[data-v-e9b77c50]{margin:0 auto;max-width:1366px;width:98vw;padding-top:0;padding-bottom:0}.print-only[data-v-e9b77c50]{padding:25px 0}.print-only table[data-v-e9b77c50]{page-break-inside:auto}.print-only tr[data-v-e9b77c50]{page-break-inside:avoid;page-break-after:auto}.print-only .item-list[data-v-e9b77c50]{margin:0 auto!important;max-width:1366px!important;width:96vw!important;position:relative;display:block}.print-only .print-header[data-v-e9b77c50],.print-only .print-total-tokens[data-v-e9b77c50]{display:block!important}.print-only .v-toolbar[data-v-e9b77c50]{display:none}.print-only .white--text[data-v-e9b77c50]{color:#fff!important;caret-color:#fff!important}.print-only .black[data-v-e9b77c50]{background-color:#000!important;border-color:#000!important}.print-only .item-list[data-v-e9b77c50],.print-only .order-number[data-v-e9b77c50]{display:block}.print-only .order-number[data-v-e9b77c50]{font-weight:700}.print-only .cart-items table[data-v-e9b77c50]{border-collapse:collapse}.print-only .cart-items tr[data-v-e9b77c50]{background-color:#fff}.print-only .cart-items td[data-v-e9b77c50],.print-only .cart-items th[data-v-e9b77c50]{border:10px solid #e0e0e0;border-width:10px 0}.print-only .computation[data-v-e9b77c50]{display:none}.print-only .v-dialog--fullscreen>.v-card[data-v-e9b77c50]{background-color:#e0e0e0;width:100%}.print-only .v-dialog--fullscreen .v-card__text[data-v-e9b77c50]{padding-top:20px!important}.print-only .layout--admin #navbar[data-v-e9b77c50],.print-only .layout--admin .application--wrap[data-v-e9b77c50],.print-only .layout--admin>footer[data-v-e9b77c50],.print-only .layout--admin>header[data-v-e9b77c50]{display:none}",""]),t.exports=e},1173:function(t,e,o){"use strict";o.r(e);o(28),o(33),o(20),o(13);var n=o(424),r=o(425),l=o(427),d="received",c=o(426),m={mixins:[n.a,r.a,l.a],mounted:function(){var t=this;this.getDownloadableLogs().then((function(e){t.downloadableLogs=e.items,t.logsTable.totalItems=e.totalItems})),this.getDataFromApi().then((function(e){t.userTransactions=e.items,t.table.totalItems=e.totalItems}))},data:function(){return{downloadableLogs:[],logsTable:{headers:[{text:"Date Generated",value:"created_at",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"",value:"",sortable:!1}],page:1,totalItems:0,isLoading:!1},logsTablePagination:{sortBy:"created_at",descending:!0},table:{receivedHeaders:[{text:"User",value:"user_name",sortable:!0},{text:"Department",value:"department_name",sortable:!0},{text:"Designation",value:"position_name",sortable:!0},{text:"Career level",value:"career_level",sortable:!1},{text:"Tokens received",value:"amount",sortable:!0},{text:"Date | Time",value:"created_at",sortable:!0}],page:1,totalItems:0,isLoading:!1},paginationReceivedTable:{},userTransactions:[],type:d,transactionType:d,today:this.$moment().format("YYYY-MM-DD"),dateFrom:"",dateTo:"",menuFrom:!1,menuTo:!1}},computed:{dateFromFormatted:function(){return this.formatDate(this.dateFrom)},dateToFormatted:function(){return this.formatDate(this.dateTo)}},methods:{downloadFile:function(t){var e=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get(this.$queryBuilder("/admin/logs/download",{id:t.id}),{responseType:"blob"}).then((function(t){c(t.data,"transaction_"+Date.now()+".csv")})).catch((function(t){t.response&&e.$toast.error(t.response.data.message)})).finally((function(){e.isDownloading=!1})))},getDownloadableLogs:function(){var t=this;return this.logsTable.isLoading=!0,new Promise((function(e,o){var n=t.logsTablePagination,r=n.sortBy,l=n.descending,d=n.page,c=n.rowsPerPage,m={page:d,query:"type:System to User Transaction"};-1===c?m.paginate=0:m.rpp=c||5,r&&(m.sort="".concat(r,":").concat(l?"desc":"asc"));t.$axios.get(t.$queryBuilder("/admin/logs/downloadables",m)).then((function(t){var o=t.data.data;-1===c&&(o=t.data),e({items:o,totalItems:t.data.total})})).catch((function(t){o(t.response)})).finally((function(){t.logsTable.isLoading=!1}))}))},generateCsv:function(){var t=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get("".concat(this.currentDownloadExcelURL,"&download=1")).then((function(e){t.getDownloadableLogs().then((function(e){t.downloadableLogs=e.items,t.logsTable.totalItems=e.totalItems}))})).catch((function(e){t.$toast.error(e.response.data.message)})).finally((function(){t.isDownloading=!1})))},getDataFromApi:function(){var t=this;return this.table.isLoading=!0,new Promise((function(e,o){var n=t.paginationReceivedTable,r=n.sortBy,l=n.descending,d=n.page,c=n.rowsPerPage,m={page:d||1,type:t.type};-1===c?m.paginate=0:m.rpp=c||5,r&&(m.sort="".concat(r,":").concat(l?"desc":"asc")),t.dateFrom&&t.dateTo&&(m.from=t.dateFrom,m.to=t.dateTo),t.currentDownloadCSVURL=t.$queryBuilder("/admin/transactions",m),t.currentDownloadExcelURL=t.$queryBuilder("/admin/transactions",m),t.$axios.get(t.$queryBuilder("/admin/transactions",m)).then((function(t){var o=t.data.data;-1===c&&(o=t.data);var n=o.map((function(i){return{id:i.id,user_name:i.user.name,email:i.user.email,department:i.user.department_name,position:i.user.position_name,career_level:i.user.career_level,amount:i.amount,created_at:i.created_at}}));e({items:n,totalItems:t.data.total})})).catch((function(t){o(t.response)})).finally((function(){t.table.isLoading=!1}))}))},retrieve:function(){var t=this;this.type=this.transactionType,this.getDataFromApi().then((function(e){t.userTransactions=e.items,t.table.totalItems=e.totalItems}))},resetSearch:function(){this.resetDateSelection(),this.retrieve()}},watch:{logsTablePagination:{handler:function(t){var e=this;this.getDownloadableLogs().then((function(t){e.downloadableLogs=t.items,e.logsTable.totalItems=t.totalItems}))},deep:!0},paginationReceivedTable:{handler:function(){var t=this;this.getDataFromApi().then((function(e){t.userTransactions=e.items,t.table.totalItems=e.totalItems}))},deep:!0}}},v=(o(1095),o(9)),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"user-transactions-page"}},[o("div",{staticClass:"container no-padding"},[o("v-toolbar",{staticClass:"pt-4",attrs:{flat:"",color:"white"}},[o("v-toolbar-title",[t._v("System-to-User transactions")]),t._v(" "),o("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),o("v-spacer"),t._v(" "),o("div",{staticClass:"container--flex container--flex-align-item-center"},[o("div",{staticClass:"dateFrom flex-1"},[o("v-menu",{ref:"menuFrom",attrs:{"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:t.menuFrom,callback:function(e){t.menuFrom=e},expression:"menuFrom"}},[o("v-text-field",{attrs:{slot:"activator",label:"From","prepend-icon":"event",color:"light-green lighten-1",readonly:""},slot:"activator",model:{value:t.dateFromFormatted,callback:function(e){t.dateFromFormatted=e},expression:"dateFromFormatted"}}),t._v(" "),o("v-date-picker",{attrs:{readonly:t.table.isLoading,reactive:!0,max:t.today,"show-current":!1,color:"light-green lighten-1","no-title":"",scrollable:""},model:{value:t.dateFrom,callback:function(e){t.dateFrom=e},expression:"dateFrom"}})],1)],1),t._v(" "),o("div",{staticClass:"dateTo flex-1"},[o("v-menu",{ref:"menuTo",attrs:{"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:t.menuTo,callback:function(e){t.menuTo=e},expression:"menuTo"}},[o("v-text-field",{attrs:{slot:"activator",label:"To","prepend-icon":"event",color:"light-green lighten-1",readonly:""},slot:"activator",model:{value:t.dateToFormatted,callback:function(e){t.dateToFormatted=e},expression:"dateToFormatted"}}),t._v(" "),o("v-date-picker",{attrs:{readonly:!t.dateFrom,reactive:!0,min:t.dateFrom,"show-current":!1,color:"light-green lighten-1","no-title":"",scrollable:""},model:{value:t.dateTo,callback:function(e){t.dateTo=e},expression:"dateTo"}},[o("v-spacer")],1)],1)],1),t._v(" "),o("div",{staticClass:"flex-1 container--flex"},[o("v-btn",{attrs:{disabled:t.table.isLoading,dark:""},on:{click:function(e){return e.preventDefault(),t.retrieve()}}},[t._v("Search")]),t._v(" "),o("v-btn",{attrs:{disabled:!t.hasDateSelected||t.table.isLoading,dark:""},on:{click:function(e){return e.preventDefault(),t.resetSearch()}}},[t._v("Reset")])],1)])],1),t._v(" "),o("v-data-table",{attrs:{headers:t.table.receivedHeaders,items:t.userTransactions,loading:t.table.isLoading,pagination:t.paginationReceivedTable,"total-items":t.table.totalItems,"item-key":"id"},on:{"update:pagination":function(e){t.paginationReceivedTable=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[o("tr",[o("td",[o("h3",[t._v(t._s(e.item.user_name))]),t._v(" "),o("p",[t._v(t._s(e.item.email))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.department))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.position))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.career_level))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.amount))])]),t._v(" "),o("td",[o("h3",[t._v("\n              "+t._s(t.formatDate(e.item.created_at)||"")),o("br"),t._v("\n              "+t._s(t.formatDate(e.item.created_at,"hh:mm A")||"")+"\n            ")])])])]}}])}),t._v(" "),o("div",{staticClass:"container no-padding",staticStyle:{"margin-top":"25px !important"}},[o("v-toolbar",{staticClass:"pt-4",attrs:{flat:"",color:"white"}},[o("v-toolbar-title",[t._v("Downloadable logs")]),t._v(" "),o("v-divider",{staticClass:"mx-2",attrs:{inset:"",vertical:""}}),t._v(" "),o("v-btn",{staticClass:"right",attrs:{dark:""},on:{click:function(e){return t.generateCsv()}}},[t._v("Generate log file")]),t._v(" "),o("v-spacer")],1),t._v(" "),o("v-data-table",{attrs:{headers:t.logsTable.headers,items:t.downloadableLogs,loading:t.logsTable.isLoading,pagination:t.logsTablePagination,"total-items":t.logsTable.totalItems,"item-key":"id"},on:{"update:pagination":function(e){t.logsTablePagination=e}},scopedSlots:t._u([{key:"items",fn:function(e){return[o("td",[o("h3",[t._v(t._s(e.item.created_at))])]),t._v(" "),o("td",[o("h3",[t._v(t._s(e.item.status))])]),t._v(" "),o("td",["ready"==e.item.status?o("v-btn",{staticClass:"right",attrs:{dark:""},on:{click:function(o){return t.downloadFile(e.item)}}},[t._v("Download")]):t._e()],1)]}}])})],1)],1)])}),[],!1,null,"e9b77c50",null);e.default=component.exports},424:function(t,e,o){"use strict";o(14);var n=o(4);e.a={middleware:"authenticated",layout:"admin",asyncData:function(t){return Object(n.a)(regeneratorRuntime.mark((function e(){var o,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.store,n=t.error,e.next=3,o.dispatch("session/fetchUserProfile");case 3:return e.next=5,o.getters["session/IS_ADMIN"];case 5:e.sent||n({statusCode:404,message:"Page not found"});case 7:case"end":return e.stop()}}),e)})))()}}},425:function(t,e,o){"use strict";e.a={methods:{formatDate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"DD MMM YYYY";return t?this.$moment(t).format(e):""},resetDateSelection:function(){this.dateFrom="",this.dateTo="",this.dateFromFormatted="",this.dateToFormatted=""}},watch:{dateTo:function(t){this.dateToFormatted=this.formatDate(this.dateTo)},dateFrom:function(t){this.dateFromFormatted=this.formatDate(this.dateFrom)}},computed:{hasDateSelected:function(){return this.dateFrom.length>0||this.dateTo.length>0}},data:function(){return{dateFrom:"",dateFromFormatted:"",dateTo:"",dateToFormatted:"",menuFrom:!1,menuTo:!1}}}},426:function(t,e){t.exports=function(data,t,e,o){var n=new Blob(void 0!==o?[o,data]:[data],{type:e||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{var r=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(n):window.webkitURL.createObjectURL(n),l=document.createElement("a");l.style.display="none",l.href=r,l.setAttribute("download",t),void 0===l.download&&l.setAttribute("target","_blank"),document.body.appendChild(l),l.click(),setTimeout((function(){document.body.removeChild(l),window.URL.revokeObjectURL(r)}),200)}}},427:function(t,e,o){"use strict";o(13);var n=o(426);e.a={methods:{downloadExcel:function(){var t=this;this.isDownloading||(this.isDownloading=!0,this.$axios.get("".concat(this.currentDownloadCSVURL,"&download=1"),{responseType:"blob"}).then((function(t){n(t.data,"reports.xlsx")})).catch((function(e){t.$toast.error(e.response.data.message)})).finally((function(){t.isDownloading=!1})))}},data:function(){return{currentDownloadCSVURL:"",isDownloading:!1}}}},696:function(t,e,o){var content=o(1096);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(3).default)("613c30c0",content,!0,{sourceMap:!1})}}]);